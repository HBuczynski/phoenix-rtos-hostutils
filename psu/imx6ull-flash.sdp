# Syntax
# WAIT <vid> <pid>
# WRITE_FILE <F/S> <quoted string> [offset] [address] [size]
# Example:
#    WRITE_FILE F "phoenix-arm-imx6ull.img" 0 0xac000000 16384   # off=0 addr=0xac000000 size=16384
#    WRITE_FILE F "phoenix-arm-imx6ull.img" 16384 0xac000000     # off=16384 addr=0xac000000 size=<whole file>
# WRITE_REGISTER <address> <value> <format 8/16/32>
# Example:
#    WRITE_REGISTER -1 0 8 # special register -1 for psd, switches file to file 0
# JUMP_ADDRESS <address>

# Wait for device
WAIT 0x15a2 0x80
ERROR_STATUS

# load kernel part with DCD initializing DDR
WRITE_FILE F "../_boot/phoenix-arm-imx6ull.img" 0 0x00907000 0x06d8
#JUMP_ADDRESS <ivt_addr>
JUMP_ADDRESS 0x00907400

# Load the rest of kernel
WAIT 0x15a2 0x80
ERROR_STATUS
WRITE_FILE F "../_boot/phoenix-arm-imx6ull.img" 0 0x80000000

# Save args to syspage
#WRITE_FILE S "Ximx6ull-uart;Xdummyfs;Xpsd /dev/flash0 /dev/flash1" # check if separated with 0
JUMP_ADDRESS 0x800006a8

# wait for psd and write files to flash
WAIT 0x15a2 0x7d
WRITE_FILE "../_boot/rootfs.img"
WRITE_REGISTER -1 1 8 # switch to second flash
WRITE_FILE "../_boot/rootfs.img"
